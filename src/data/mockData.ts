import { Alert, UnifiedLog, Detection, Simulation, SecurityPosture, AlertCounts, TimelineEvent } from '@/types/siem';

export const mockAlerts: Alert[] = [
  {
    id: 'ALT-001',
    timestamp: '2024-01-17T14:32:15Z',
    severity: 'CRITICAL',
    detectionType: 'PRIVILEGE_ESCALATION',
    user: 'jsmith',
    service: 'sudo',
    reason: 'User executed sudo command with NOPASSWD override detected',
    rawLog: 'Jan 17 14:32:15 server01 sudo: jsmith : TTY=pts/0 ; PWD=/home/jsmith ; USER=root ; COMMAND=/bin/bash',
    mitreAttackId: 'T1548.003',
    correlatedEvents: ['Failed SSH attempts from same user', 'Unusual login time'],
  },
  {
    id: 'ALT-002',
    timestamp: '2024-01-17T14:28:44Z',
    severity: 'ALERT',
    detectionType: 'SERVICE_RESTART_ABUSE',
    service: 'rsyslog',
    reason: 'Logging service restarted 5 times in 10 minutes - potential log evasion',
    rawLog: 'Jan 17 14:28:44 server01 systemd[1]: Stopped System Logging Service.',
    mitreAttackId: 'T1562.002',
    correlatedEvents: ['Previous service restarts', 'Log rotation detected'],
  },
  {
    id: 'ALT-003',
    timestamp: '2024-01-17T14:25:12Z',
    severity: 'ALERT',
    detectionType: 'DNS_ANOMALY',
    sourceIp: '192.168.1.105',
    destinationIp: '8.8.8.8',
    service: 'dns',
    reason: 'High volume DNS queries to suspicious TLD (.xyz) - possible C2 beaconing',
    mitreAttackId: 'T1071.004',
    correlatedEvents: ['Repeated queries to same domain', 'Unusual query timing'],
  },
  {
    id: 'ALT-004',
    timestamp: '2024-01-17T14:20:33Z',
    severity: 'WARNING',
    detectionType: 'BRUTE_FORCE',
    sourceIp: '10.0.0.55',
    user: 'admin',
    service: 'sshd',
    reason: 'Multiple failed login attempts detected (15 in 5 minutes)',
    rawLog: 'Jan 17 14:20:33 server01 sshd[12345]: Failed password for admin from 10.0.0.55',
    mitreAttackId: 'T1110.001',
    correlatedEvents: ['Previous failed attempts', 'Lockout triggered'],
  },
  {
    id: 'ALT-005',
    timestamp: '2024-01-17T14:15:00Z',
    severity: 'INFO',
    detectionType: 'SUSPICIOUS_COMMAND',
    user: 'deploy',
    service: 'bash',
    reason: 'Base64 encoded command execution detected',
    rawLog: 'Jan 17 14:15:00 server01 bash: deploy executed: echo "dGVzdA==" | base64 -d | bash',
    mitreAttackId: 'T1027',
    correlatedEvents: [],
  },
  {
    id: 'ALT-006',
    timestamp: '2024-01-17T14:10:22Z',
    severity: 'CRITICAL',
    detectionType: 'TIME_MANIPULATION',
    service: 'ntpd',
    reason: 'System time changed by 2 hours - potential log timestamp manipulation',
    rawLog: 'Jan 17 14:10:22 server01 ntpd[1234]: time reset +7200.000000 s',
    mitreAttackId: 'T1070.006',
    correlatedEvents: ['NTP service restart', 'Config file modification'],
  },
  {
    id: 'ALT-007',
    timestamp: '2024-01-17T14:05:18Z',
    severity: 'ALERT',
    detectionType: 'HTTP_ANOMALY',
    sourceIp: '192.168.1.200',
    destinationIp: '203.0.113.50',
    service: 'suricata',
    reason: 'Suspicious HTTP POST to known malware distribution URL',
    mitreAttackId: 'T1071.001',
    correlatedEvents: ['Previous connections to same IP', 'Unusual payload size'],
  },
  {
    id: 'ALT-008',
    timestamp: '2024-01-17T13:58:45Z',
    severity: 'WARNING',
    detectionType: 'LOG_TAMPERING',
    service: 'logrotate',
    reason: 'Unexpected log rotation detected outside scheduled window',
    rawLog: 'Jan 17 13:58:45 server01 logrotate: rotating /var/log/auth.log',
    mitreAttackId: 'T1070.002',
    correlatedEvents: ['Manual cron job execution', 'Disk space normal'],
  },
];

export const mockLogs: UnifiedLog[] = [
  { id: 'LOG-001', timestamp: '2024-01-17T14:32:15Z', source: 'auth', service: 'sudo', message: 'jsmith : TTY=pts/0 ; PWD=/home/jsmith ; USER=root ; COMMAND=/bin/bash', user: 'jsmith' },
  { id: 'LOG-002', timestamp: '2024-01-17T14:32:10Z', source: 'syslog', service: 'kernel', message: 'audit: type=1400 audit(1705500735.123:456): avc: denied { execute }' },
  { id: 'LOG-003', timestamp: '2024-01-17T14:32:05Z', source: 'suricata', service: 'suricata', message: '{"event_type":"alert","src_ip":"192.168.1.105","dest_ip":"203.0.113.50","alert":{"signature":"ET MALWARE"}}', ip: '192.168.1.105' },
  { id: 'LOG-004', timestamp: '2024-01-17T14:31:58Z', source: 'auth', service: 'sshd', message: 'Accepted publickey for deploy from 10.0.0.10 port 52341', user: 'deploy', ip: '10.0.0.10' },
  { id: 'LOG-005', timestamp: '2024-01-17T14:31:45Z', source: 'syslog', service: 'systemd', message: 'Started Session 1234 of user jsmith.' },
  { id: 'LOG-006', timestamp: '2024-01-17T14:31:30Z', source: 'auth', service: 'sshd', message: 'Failed password for admin from 10.0.0.55 port 44521', user: 'admin', ip: '10.0.0.55', severity: 'WARNING' },
  { id: 'LOG-007', timestamp: '2024-01-17T14:31:15Z', source: 'suricata', service: 'suricata', message: '{"event_type":"dns","dns":{"type":"query","rrname":"suspicious.xyz"}}' },
  { id: 'LOG-008', timestamp: '2024-01-17T14:31:00Z', source: 'syslog', service: 'cron', message: 'CMD (/usr/bin/logrotate /etc/logrotate.conf)' },
  { id: 'LOG-009', timestamp: '2024-01-17T14:30:45Z', source: 'auth', service: 'su', message: 'pam_unix(su:session): session opened for user root by jsmith', user: 'jsmith' },
  { id: 'LOG-010', timestamp: '2024-01-17T14:30:30Z', source: 'syslog', service: 'rsyslog', message: 'rsyslogd: action queue started' },
];

export const mockDetections: Detection[] = [
  {
    type: 'PRIVILEGE_ESCALATION',
    name: 'Privilege Escalation via Sudo',
    description: 'Detects when users execute commands with elevated privileges using sudo, especially with NOPASSWD configurations or suspicious command patterns.',
    whyItMatters: 'Attackers often exploit sudo misconfigurations to gain root access. Monitoring sudo usage helps detect both insider threats and compromised accounts attempting lateral movement.',
    mitreAttackId: 'T1548.003',
    mitreAttackName: 'Abuse Elevation Control Mechanism: Sudo and Sudo Caching',
    mitreTactic: 'Privilege Escalation, Defense Evasion',
  },
  {
    type: 'SERVICE_RESTART_ABUSE',
    name: 'Logging Service Restart Abuse',
    description: 'Detects excessive restarts of logging services (rsyslog, syslog-ng, auditd) using behavioral thresholding.',
    whyItMatters: 'Attackers restart logging services to clear buffers, prevent log collection, or reset log file handles as part of anti-forensics.',
    mitreAttackId: 'T1562.002',
    mitreAttackName: 'Impair Defenses: Disable Windows Event Logging',
    mitreTactic: 'Defense Evasion',
  },
  {
    type: 'DNS_ANOMALY',
    name: 'DNS Anomaly Detection',
    description: 'Identifies suspicious DNS queries including high-volume lookups, unusual TLDs, long domain names (potential DNS tunneling), and queries to known malicious domains.',
    whyItMatters: 'DNS is commonly used for C2 communications, data exfiltration, and tunneling. Anomalous DNS patterns often indicate malware beaconing or active intrusions.',
    mitreAttackId: 'T1071.004',
    mitreAttackName: 'Application Layer Protocol: DNS',
    mitreTactic: 'Command and Control',
  },
  {
    type: 'HTTP_ANOMALY',
    name: 'HTTP/HTTPS Anomaly Detection',
    description: 'Detects suspicious HTTP traffic patterns including connections to known malicious IPs, unusual POST payloads, and beaconing behavior.',
    whyItMatters: 'HTTP/HTTPS is the most common protocol for malware communications. Detecting anomalies helps identify data exfiltration and C2 traffic.',
    mitreAttackId: 'T1071.001',
    mitreAttackName: 'Application Layer Protocol: Web Protocols',
    mitreTactic: 'Command and Control',
  },
  {
    type: 'TIME_MANIPULATION',
    name: 'System Time Manipulation',
    description: 'Detects changes to system time via NTP modifications, manual date/time commands, or hardware clock tampering.',
    whyItMatters: 'Attackers manipulate time to invalidate security certificates, confuse log correlation, or bypass time-based access controls.',
    mitreAttackId: 'T1070.006',
    mitreAttackName: 'Indicator Removal on Host: Timestomp',
    mitreTactic: 'Defense Evasion',
  },
  {
    type: 'LOG_TAMPERING',
    name: 'Log Tampering Detection',
    description: 'Identifies suspicious log file modifications including unexpected rotations, deletions, truncations, and permission changes.',
    whyItMatters: 'Log tampering is a key anti-forensics technique. Detecting it early can indicate an active attack before evidence is destroyed.',
    mitreAttackId: 'T1070.002',
    mitreAttackName: 'Indicator Removal on Host: Clear Linux or Mac System Logs',
    mitreTactic: 'Defense Evasion',
  },
  {
    type: 'BRUTE_FORCE',
    name: 'Brute Force Attack Detection',
    description: 'Identifies multiple failed authentication attempts from single or distributed sources against SSH, sudo, and other services.',
    whyItMatters: 'Brute force attacks are a common initial access technique. Early detection allows blocking attackers before successful compromise.',
    mitreAttackId: 'T1110.001',
    mitreAttackName: 'Brute Force: Password Guessing',
    mitreTactic: 'Credential Access',
  },
  {
    type: 'SUSPICIOUS_COMMAND',
    name: 'Suspicious Command Execution',
    description: 'Detects execution of potentially malicious commands including encoded payloads, reverse shells, and reconnaissance tools.',
    whyItMatters: 'Post-exploitation often involves running encoded commands to evade detection. Identifying these patterns helps catch attackers during active operations.',
    mitreAttackId: 'T1027',
    mitreAttackName: 'Obfuscated Files or Information',
    mitreTactic: 'Defense Evasion',
  },
];

export const mockSimulations: Simulation[] = [
  {
    id: 'SIM-001',
    name: 'Privilege Escalation via Sudo',
    description: 'Simulates a user gaining root access through sudo command abuse.',
    expectedAlerts: [
      { severity: 'CRITICAL', type: 'PRIVILEGE_ESCALATION' },
      { severity: 'INFO', type: 'SUSPICIOUS_COMMAND' },
    ],
    status: 'ready',
  },
  {
    id: 'SIM-002',
    name: 'SSH Brute Force Attack',
    description: 'Simulates multiple failed SSH login attempts from a single source.',
    expectedAlerts: [
      { severity: 'WARNING', type: 'BRUTE_FORCE' },
      { severity: 'ALERT', type: 'BRUTE_FORCE' },
    ],
    status: 'ready',
  },
  {
    id: 'SIM-003',
    name: 'DNS Tunneling / C2 Beaconing',
    description: 'Simulates DNS queries to suspicious domains mimicking C2 communications.',
    expectedAlerts: [
      { severity: 'ALERT', type: 'DNS_ANOMALY' },
    ],
    status: 'ready',
  },
  {
    id: 'SIM-004',
    name: 'Log Tampering Sequence',
    description: 'Simulates logging service restarts and unexpected log rotations.',
    expectedAlerts: [
      { severity: 'ALERT', type: 'SERVICE_RESTART_ABUSE' },
      { severity: 'WARNING', type: 'LOG_TAMPERING' },
    ],
    status: 'ready',
  },
  {
    id: 'SIM-005',
    name: 'Time Manipulation Attack',
    description: 'Simulates system time changes that could affect log integrity.',
    expectedAlerts: [
      { severity: 'CRITICAL', type: 'TIME_MANIPULATION' },
    ],
    status: 'ready',
  },
];

export const mockSecurityPosture: SecurityPosture = 'SUSPICIOUS';

export const mockAlertCounts: AlertCounts = {
  critical: 2,
  alert: 3,
  warning: 2,
  info: 1,
  total: 8,
};

export const mockTimelineEvents: TimelineEvent[] = [
  { timestamp: '14:32', severity: 'CRITICAL', label: 'Privilege Escalation' },
  { timestamp: '14:28', severity: 'ALERT', label: 'Service Restart Abuse' },
  { timestamp: '14:25', severity: 'ALERT', label: 'DNS Anomaly' },
  { timestamp: '14:20', severity: 'WARNING', label: 'Brute Force' },
  { timestamp: '14:15', severity: 'INFO', label: 'Suspicious Command' },
  { timestamp: '14:10', severity: 'CRITICAL', label: 'Time Manipulation' },
  { timestamp: '14:05', severity: 'ALERT', label: 'HTTP Anomaly' },
  { timestamp: '13:58', severity: 'WARNING', label: 'Log Tampering' },
];
